var h=this;
function k(){function m(d,g){var a=this;g=void 0===g?n:g;this.s=document.createElement("a");this.clearSourceBuffer=function(){if(a.j)for(var b=a.j.sourceBuffers,c=0;c<b.length;c++)a.j.removeSourceBuffer(b[c]);return a};this.clearSteam=function(){if(a.h)for(var b=a.h.getTracks(),c=0;c<b.length;c++)b[c].enabled=!1,b[c].stop(),a.h.removeTrack(b[c]);return a};this.destroy=function(){a.clearSourceBuffer().clearSteam();a.i=[];return a};this.download=function(b){b=void 0===b?"untitled_"+(new Date).getTime():b;
var c=window.URL.createObjectURL(new Blob(a.i,{type:"video/"+a.options.format})),f=a.s;f.href=c;f.download=b+"."+a.options.format;document.body.appendChild(f);f.click();setTimeout(function(){document.body.removeChild(f);window.URL.revokeObjectURL(c)},0);return a};this.getBlob=function(){return new Blob(a.i,{type:"video/"+a.options.format})};this.getUrl=function(){return window.URL.createObjectURL(a.getBlob())};this.pause=function(){a.state===e.l&&a.g&&(a.g.pause(),a.state=e.paused);return a};this.resetOptions=
function(b){a.options=Object.assign({},n,b);return a.destroy().o()};this.resume=function(){a.state===e.paused&&a.g&&(a.g.resume(),a.state=e.l);return a};this.start=function(b){b=void 0===b?100:b;a.i=[];a.g=a.g||a.m();if(!a.g)return a.state=e.error,a;a.g.ondataavailable=function(c){c.data&&0<c.data.size&&a.i.push(c.data)};a.g.start(b);a.state=e.l;return a};this.stop=function(){a.state=e.stopped;a.g&&a.g.stop();return a};this.toggle=function(){a.state===e.stopped?a.start():a.state===e.l?a.stop():a.state===
e.paused&&a.resume();return a};this.o=function(){a.j=new MediaSource;a.h=a.canvas.captureStream(a.options.fps);return a};this.m=function(){var b=a.options,c=b.format;b={mimeType:"video/"+c+";codecs="+b.codecs};c={mimeType:"video/"+c};return MediaRecorder.isTypeSupported(b.mimeType)?new MediaRecorder(a.h,b):MediaRecorder.isTypeSupported(c.mimeType)?new MediaRecorder(a.h,c):!1};this.canvas=d;this.resetOptions(g)}var l;(function(d){d.VP8="vp8";d.VP9="vp9";d.Opus="Opus";d.iSAC="isac";d.iLBC="ilbc";d.H264=
"h264"})(l||(l={}));var e;(function(d){d.error="error";d.paused="paused";d.started="started";d.stopped="stopped"})(e||(e={}));var n={fps:60,format:"webm",codecs:l.u};m.isAvaliable=function(d){return MediaSource&&d.captureStream};return m}"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.v?define(k):(h="undefined"!==typeof globalThis?globalThis:h||self,h.WebRTCRecorder=k());
