'use strict';var f=this;
function g(){var h;(function(c){c.VP8="vp8";c.VP9="vp9";c.Opus="Opus";c.iSAC="isac";c.iLBC="ilbc";c.H264="h264"})(h||(h={}));var d;(function(c){c.error="error";c.paused="paused";c.started="started";c.stopped="stopped"})(d||(d={}));const k={fps:60,format:"webm",codecs:h.u};class l{constructor(c,m=k){this.s=document.createElement("a");this.clearSourceBuffer=()=>{if(this.j){let b=this.j.sourceBuffers;for(var a=0;a<b.length;a++)this.j.removeSourceBuffer(b[a])}return this};this.clearSteam=()=>{if(this.h){let b=
this.h.getTracks();for(var a=0;a<b.length;a++)b[a].enabled=!1,b[a].stop(),this.h.removeTrack(b[a])}return this};this.destroy=()=>{this.clearSourceBuffer().clearSteam();this.i=[];return this};this.download=(a="untitled_"+(new Date).getTime())=>{const b=window.URL.createObjectURL(new Blob(this.i,{type:"video/"+this.options.format})),e=this.s;e.href=b;e.download=a+"."+this.options.format;document.body.appendChild(e);e.click();setTimeout(()=>{document.body.removeChild(e);window.URL.revokeObjectURL(b)},
0);return this};this.getBlob=()=>new Blob(this.i,{type:"video/"+this.options.format});this.getUrl=()=>window.URL.createObjectURL(this.getBlob());this.pause=()=>{this.state===d.l&&this.g&&(this.g.pause(),this.state=d.paused);return this};this.resetOptions=a=>{this.options={...k,...a};return this.destroy().o()};this.resume=()=>{this.state===d.paused&&this.g&&(this.g.resume(),this.state=d.l);return this};this.start=(a=100)=>{this.i=[];this.g=this.g||this.m();if(!this.g)return this.state=d.error,this;
this.g.ondataavailable=b=>{b.data&&0<b.data.size&&this.i.push(b.data)};this.g.start(a);this.state=d.l;return this};this.stop=()=>{this.state=d.stopped;this.g&&this.g.stop();return this};this.toggle=()=>{this.state===d.stopped?this.start():this.state===d.l?this.stop():this.state===d.paused&&this.resume();return this};this.o=()=>{this.j=new MediaSource;this.h=this.canvas.captureStream(this.options.fps);return this};this.m=()=>{var a=this.options.format;const b={mimeType:"video/"+a+";codecs="+this.options.codecs};
a={mimeType:"video/"+a};return MediaRecorder.isTypeSupported(b.mimeType)?new MediaRecorder(this.h,b):MediaRecorder.isTypeSupported(a.mimeType)?new MediaRecorder(this.h,a):!1};this.canvas=c;this.resetOptions(m)}}l.isAvaliable=c=>MediaSource&&c.captureStream;return l}"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.v?define(g):(f="undefined"!==typeof globalThis?globalThis:f||self,f.WebRTCRecorder=g());
